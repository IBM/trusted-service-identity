[
    {
        "op": "replace",
        "path": "/metadata/annotations",
        "value": {
            "admission.trusted.identity/inject": "true",
            "admission.trusted.identity/status": "mutated",
            "admission.trusted.identity/tsi-cluster-name": "minikube",
            "admission.trusted.identity/tsi-images": "ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4,trustedseriviceidentity/ti-jwt-sidecar:v1.8.3,trustedseriviceidentity/ti-jwt-sidecar:v1.8.3",
            "admission.trusted.identity/tsi-region": "eu-de",
            "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"v1\",\"kind\":\"Pod\",\"metadata\":{\"annotations\":{\"admission.trusted.identity/inject\":\"true\",\"admission.trusted.identity/status\":\"mutated\",\"admission.trusted.identity/tsi-cluster-name\":\"minikube\",\"admission.trusted.identity/tsi-images\":\"ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4\",\"admission.trusted.identity/tsi-region\":\"eu-de\",\"tsi.secrets\":\"- tsi.secret/name: \\\"mysecret1xxx\\\"\\n  tsi.secret/constraints: \\\"region,images\\\"\\n  tsi.secret/local-path: \\\"tsi-secrets/\\\"\\n- tsi.secret/name: \\\"mysecret2\\\"\\n  tsi.secret/constraints: \\\"region\\\"\\n  tsi.secret/local-path: \\\"tsi-secrets\\\"\\n\"},\"creationTimestamp\":\"2020-12-09T15:57:57Z\",\"generateName\":\"myubuntu-6d5c486b66-\",\"labels\":{\"app\":\"myubuntu\",\"pod-template-hash\":\"6d5c486b66\"},\"managedFields\":[{\"apiVersion\":\"v1\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:admission.trusted.identity/inject\":{},\"f:tsi.secrets\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:app\":{},\"f:pod-template-hash\":{}},\"f:ownerReferences\":{\".\":{},\"k:{\\\"uid\\\":\\\"67635c98-ddee-49eb-a3c1-12a0c7bb15f0\\\"}\":{\".\":{},\"f:apiVersion\":{},\"f:blockOwnerDeletion\":{},\"f:controller\":{},\"f:kind\":{},\"f:name\":{},\"f:uid\":{}}}},\"f:spec\":{\"f:containers\":{\"k:{\\\"name\\\":\\\"myubuntu\\\"}\":{\".\":{},\"f:args\":{},\"f:command\":{},\"f:image\":{},\"f:imagePullPolicy\":{},\"f:name\":{},\"f:resources\":{},\"f:terminationMessagePath\":{},\"f:terminationMessagePolicy\":{}}},\"f:dnsPolicy\":{},\"f:enableServiceLinks\":{},\"f:restartPolicy\":{},\"f:schedulerName\":{},\"f:securityContext\":{},\"f:terminationGracePeriodSeconds\":{}}},\"manager\":\"kube-controller-manager\",\"operation\":\"Update\",\"time\":\"2020-12-09T15:57:57Z\"},{\"apiVersion\":\"v1\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:status\":{\"f:conditions\":{\"k:{\\\"type\\\":\\\"ContainersReady\\\"}\":{\".\":{},\"f:lastProbeTime\":{},\"f:lastTransitionTime\":{},\"f:message\":{},\"f:reason\":{},\"f:status\":{},\"f:type\":{}},\"k:{\\\"type\\\":\\\"Initialized\\\"}\":{\".\":{},\"f:lastProbeTime\":{},\"f:lastTransitionTime\":{},\"f:message\":{},\"f:reason\":{},\"f:status\":{},\"f:type\":{}},\"k:{\\\"type\\\":\\\"Ready\\\"}\":{\".\":{},\"f:lastProbeTime\":{},\"f:lastTransitionTime\":{},\"f:message\":{},\"f:reason\":{},\"f:status\":{},\"f:type\":{}}},\"f:containerStatuses\":{},\"f:hostIP\":{},\"f:initContainerStatuses\":{},\"f:podIP\":{},\"f:podIPs\":{\".\":{},\"k:{\\\"ip\\\":\\\"172.18.0.5\\\"}\":{\".\":{},\"f:ip\":{}}},\"f:startTime\":{}}},\"manager\":\"kubelet\",\"operation\":\"Update\",\"time\":\"2020-12-09T15:58:00Z\"}],\"name\":\"myubuntu-6d5c486b66-dkdl5\",\"namespace\":\"test\",\"ownerReferences\":[{\"apiVersion\":\"apps/v1\",\"blockOwnerDeletion\":true,\"controller\":true,\"kind\":\"ReplicaSet\",\"name\":\"myubuntu-6d5c486b66\",\"uid\":\"67635c98-ddee-49eb-a3c1-12a0c7bb15f0\"}],\"resourceVersion\":\"512738\",\"selfLink\":\"/api/v1/namespaces/test/pods/myubuntu-6d5c486b66-dkdl5\",\"uid\":\"011ff3cf-e7a4-422f-811e-f12ca3c42498\"},\"spec\":{\"containers\":[{\"args\":[\"while true; do ls /tsi-secrets; sleep 15; done;\"],\"command\":[\"/bin/bash\",\"-c\",\"--\"],\"image\":\"ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4\",\"imagePullPolicy\":\"Always\",\"name\":\"myubuntu\",\"resources\":{},\"terminationMessagePath\":\"/dev/termination-log\",\"terminationMessagePolicy\":\"File\",\"volumeMounts\":[{\"mountPath\":\"/var/run/secrets/kubernetes.io/serviceaccount\",\"name\":\"default-token-ncgzw\",\"readOnly\":true},{\"mountPath\":\"/tsi-secrets\",\"name\":\"tsi-secrets\",\"readOnly\":true}]},{\"env\":[{\"name\":\"HOST_IP\",\"valueFrom\":{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"status.hostIP\"}}},{\"name\":\"IS_SIDECAR\",\"value\":\"true\"},{\"name\":\"JWT_TTL_SEC\",\"value\":\"60\"},{\"name\":\"VAULT_ADDR\",\"value\":\"http://tsi-vault-v171.tsi-fra02-5240a919746a818fd9d58aa25c34ecfe-0000.eu-de.containers.appdomain.cloud\"},{\"name\":\"SECRET_REFRESH_SEC\",\"value\":\"600\"},{\"name\":\"IDENTITY_REFRESH_SEC\"}],\"image\":\"trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"imagePullPolicy\":\"Always\",\"name\":\"jwt-sidecar\",\"resources\":{},\"securityContext\":{\"runAsUser\":0},\"terminationMessagePath\":\"/dev/termination-log\",\"terminationMessagePolicy\":\"File\",\"volumeMounts\":[{\"mountPath\":\"/usr/share/secrets/tsi-secrets\",\"name\":\"tsi-secrets\"},{\"mountPath\":\"/host/sockets\",\"name\":\"tsi-sockets\"},{\"mountPath\":\"/pod-metadata\",\"name\":\"pod-metadata\",\"readOnly\":true},{\"mountPath\":\"/host/machineid\",\"name\":\"host-machineid\",\"readOnly\":true},{\"mountPath\":\"/var/run/secrets/kubernetes.io/serviceaccount\",\"name\":\"default-token-ncgzw\",\"readOnly\":true}]}],\"dnsPolicy\":\"ClusterFirst\",\"enableServiceLinks\":true,\"initContainers\":[{\"env\":[{\"name\":\"HOST_IP\",\"valueFrom\":{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"status.hostIP\"}}},{\"name\":\"IS_SIDECAR\",\"value\":\"false\"},{\"name\":\"JWT_TTL_SEC\",\"value\":\"60\"},{\"name\":\"VAULT_ADDR\",\"value\":\"http://tsi-vault-v171.tsi-fra02-5240a919746a818fd9d58aa25c34ecfe-0000.eu-de.containers.appdomain.cloud\"},{\"name\":\"SECRET_REFRESH_SEC\",\"value\":\"600\"},{\"name\":\"IDENTITY_REFRESH_SEC\",\"value\":\"600\"}],\"image\":\"trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"imagePullPolicy\":\"Always\",\"name\":\"jwt-init\",\"resources\":{},\"securityContext\":{\"runAsUser\":0},\"terminationMessagePath\":\"/dev/termination-log\",\"terminationMessagePolicy\":\"File\",\"volumeMounts\":[{\"mountPath\":\"/usr/share/secrets/tsi-secrets\",\"name\":\"tsi-secrets\"},{\"mountPath\":\"/host/sockets\",\"name\":\"tsi-sockets\"},{\"mountPath\":\"/pod-metadata\",\"name\":\"pod-metadata\",\"readOnly\":true},{\"mountPath\":\"/host/machineid\",\"name\":\"host-machineid\",\"readOnly\":true},{\"mountPath\":\"/var/run/secrets/kubernetes.io/serviceaccount\",\"name\":\"default-token-ncgzw\",\"readOnly\":true}]}],\"nodeName\":\"minikube\",\"priority\":0,\"restartPolicy\":\"Always\",\"schedulerName\":\"default-scheduler\",\"securityContext\":{},\"serviceAccount\":\"default\",\"serviceAccountName\":\"default\",\"terminationGracePeriodSeconds\":30,\"tolerations\":[{\"effect\":\"NoExecute\",\"key\":\"node.kubernetes.io/not-ready\",\"operator\":\"Exists\",\"tolerationSeconds\":300},{\"effect\":\"NoExecute\",\"key\":\"node.kubernetes.io/unreachable\",\"operator\":\"Exists\",\"tolerationSeconds\":300}],\"volumes\":[{\"name\":\"default-token-ncgzw\",\"secret\":{\"defaultMode\":420,\"secretName\":\"default-token-ncgzw\"}},{\"emptyDir\":{},\"name\":\"tsi-secrets\"},{\"hostPath\":{\"path\":\"/var/tsi-secure/sockets\",\"type\":\"Directory\"},\"name\":\"tsi-sockets\"},{\"hostPath\":{\"path\":\"/etc/machine-id\",\"type\":\"File\"},\"name\":\"host-machineid\"},{\"downwardAPI\":{\"defaultMode\":420,\"items\":[{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['tsi.secrets']\"},\"path\":\"tsi-secrets\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['tsi.identities']\"},\"path\":\"tsi-identities\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['admission.trusted.identity/ti-identity']\"},\"path\":\"ti-identity\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.name\"},\"path\":\"ti-pod-name\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.namespace\"},\"path\":\"ti-pod-namespace\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['admission.trusted.identity/tsi-images']\"},\"path\":\"tsi-images\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['admission.trusted.identity/tsi-cluster-name']\"},\"path\":\"tsi-cluster-name\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['admission.trusted.identity/tsi-region']\"},\"path\":\"tsi-region\"}]},\"name\":\"pod-metadata\"}]},\"status\":{\"conditions\":[{\"lastProbeTime\":null,\"lastTransitionTime\":\"2020-12-09T15:57:57Z\",\"message\":\"containers with incomplete status: [jwt-init]\",\"reason\":\"ContainersNotInitialized\",\"status\":\"False\",\"type\":\"Initialized\"},{\"lastProbeTime\":null,\"lastTransitionTime\":\"2020-12-09T15:57:57Z\",\"message\":\"containers with unready status: [myubuntu jwt-sidecar]\",\"reason\":\"ContainersNotReady\",\"status\":\"False\",\"type\":\"Ready\"},{\"lastProbeTime\":null,\"lastTransitionTime\":\"2020-12-09T15:57:57Z\",\"message\":\"containers with unready status: [myubuntu jwt-sidecar]\",\"reason\":\"ContainersNotReady\",\"status\":\"False\",\"type\":\"ContainersReady\"},{\"lastProbeTime\":null,\"lastTransitionTime\":\"2020-12-09T15:57:57Z\",\"status\":\"True\",\"type\":\"PodScheduled\"}],\"containerStatuses\":[{\"image\":\"trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"imageID\":\"\",\"lastState\":{},\"name\":\"jwt-sidecar\",\"ready\":false,\"restartCount\":0,\"started\":false,\"state\":{\"waiting\":{\"reason\":\"PodInitializing\"}}},{\"image\":\"ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4\",\"imageID\":\"\",\"lastState\":{},\"name\":\"myubuntu\",\"ready\":false,\"restartCount\":0,\"started\":false,\"state\":{\"waiting\":{\"reason\":\"PodInitializing\"}}}],\"hostIP\":\"172.17.0.2\",\"initContainerStatuses\":[{\"containerID\":\"docker://d60512fdecf894c328ab1b04a8138274b1623b94560a51a0cd71e4a5f5bbefc6\",\"image\":\"trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"imageID\":\"docker-pullable://trustedseriviceidentity/ti-jwt-sidecar@sha256:c99941a4171d2dd08e6487aa92b23b3ddf3b695543ba78988a1e26a0679f1b3a\",\"lastState\":{},\"name\":\"jwt-init\",\"ready\":false,\"restartCount\":0,\"state\":{\"running\":{\"startedAt\":\"2020-12-09T15:58:00Z\"}}}],\"phase\":\"Pending\",\"podIP\":\"172.18.0.5\",\"podIPs\":[{\"ip\":\"172.18.0.5\"}],\"qosClass\":\"BestEffort\",\"startTime\":\"2020-12-09T15:57:57Z\"}}\n",
            "tsi.secrets": "- tsi.secret/name: \"mysecret1xxx\"\n  tsi.secret/constraints: \"region,images\"\n  tsi.secret/local-path: \"tsi-secrets/\"\n- tsi.secret/name: \"mysecret2\"\n  tsi.secret/constraints: \"region\"\n  tsi.secret/local-path: \"tsi-secrets\"\n"
        }
    }
]
