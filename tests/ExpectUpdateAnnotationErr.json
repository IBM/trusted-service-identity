[
    {
        "op": "replace",
        "path": "/metadata/annotations",
        "value": {
            "admission.trusted.identity/inject": "true",
            "admission.trusted.identity/status": "mutated",
            "admission.trusted.identity/tsi-cluster-name": "minikube",
            "admission.trusted.identity/tsi-images": "ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4,trustedseriviceidentity/ti-jwt-sidecar:v1.8.3,trustedseriviceidentity/ti-jwt-sidecar:v1.8.3",
            "admission.trusted.identity/tsi-region": "eu-de",
            "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"v1\",\"kind\":\"Pod\",\"metadata\":{\"annotations\":{\"admission.trusted.identity/inject\":\"true\",\"admission.trusted.identity/status\":\"mutated\",\"admission.trusted.identity/tsi-cluster-name\":\"minikube\",\"admission.trusted.identity/tsi-images\":\"ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4,trustedseriviceidentity/ti-jwt-sidecar:v1.8.3,trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"admission.trusted.identity/tsi-region\":\"eu-de\",\"tsi.secrets\":\"- tsi.secret/name: \\\"mysecret1xxx\\\"\\n  tsi.secret/constraints: \\\"region,images\\\"\\n  tsi.secret/local-path: \\\"tsi-secrets/\\\"\\n- tsi.secret/name: \\\"mysecret2\\\"\\n  tsi.secret/constraints: \\\"region\\\"\\n  tsi.secret/local-path: \\\"tsi-secrets\\\"\\n\"},\"creationTimestamp\":\"2020-12-08T19:00:00Z\",\"deletionGracePeriodSeconds\":30,\"deletionTimestamp\":\"2020-12-08T20:19:05Z\",\"generateName\":\"myubuntu-6d5c486b66-\",\"labels\":{\"app\":\"myubuntu\",\"pod-template-hash\":\"6d5c486b66\"},\"managedFields\":[{\"apiVersion\":\"v1\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:admission.trusted.identity/inject\":{},\"f:tsi.secrets\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:app\":{},\"f:pod-template-hash\":{}},\"f:ownerReferences\":{\".\":{},\"k:{\\\"uid\\\":\\\"d586ee55-c3d0-4b54-bdfb-87056fd7eade\\\"}\":{\".\":{},\"f:apiVersion\":{},\"f:blockOwnerDeletion\":{},\"f:controller\":{},\"f:kind\":{},\"f:name\":{},\"f:uid\":{}}}},\"f:spec\":{\"f:containers\":{\"k:{\\\"name\\\":\\\"myubuntu\\\"}\":{\".\":{},\"f:args\":{},\"f:command\":{},\"f:image\":{},\"f:imagePullPolicy\":{},\"f:name\":{},\"f:resources\":{},\"f:terminationMessagePath\":{},\"f:terminationMessagePolicy\":{}}},\"f:dnsPolicy\":{},\"f:enableServiceLinks\":{},\"f:restartPolicy\":{},\"f:schedulerName\":{},\"f:securityContext\":{},\"f:terminationGracePeriodSeconds\":{}}},\"manager\":\"kube-controller-manager\",\"operation\":\"Update\",\"time\":\"2020-12-08T18:59:59Z\"},{\"apiVersion\":\"v1\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:status\":{\"f:conditions\":{\"k:{\\\"type\\\":\\\"ContainersReady\\\"}\":{\".\":{},\"f:lastProbeTime\":{},\"f:lastTransitionTime\":{},\"f:status\":{},\"f:type\":{}},\"k:{\\\"type\\\":\\\"Initialized\\\"}\":{\".\":{},\"f:lastProbeTime\":{},\"f:lastTransitionTime\":{},\"f:status\":{},\"f:type\":{}},\"k:{\\\"type\\\":\\\"Ready\\\"}\":{\".\":{},\"f:lastProbeTime\":{},\"f:lastTransitionTime\":{},\"f:status\":{},\"f:type\":{}}},\"f:containerStatuses\":{},\"f:hostIP\":{},\"f:initContainerStatuses\":{},\"f:phase\":{},\"f:podIP\":{},\"f:podIPs\":{\".\":{},\"k:{\\\"ip\\\":\\\"172.18.0.5\\\"}\":{\".\":{},\"f:ip\":{}}},\"f:startTime\":{}}},\"manager\":\"kubelet\",\"operation\":\"Update\",\"time\":\"2020-12-08T19:00:33Z\"},{\"apiVersion\":\"v1\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:admission.trusted.identity/tsi-cluster-name\":{}}}},\"manager\":\"kubectl-patch\",\"operation\":\"Update\",\"time\":\"2020-12-08T20:10:59Z\"}],\"name\":\"myubuntu-6d5c486b66-whfwv\",\"namespace\":\"test\",\"ownerReferences\":[{\"apiVersion\":\"apps/v1\",\"blockOwnerDeletion\":true,\"controller\":true,\"kind\":\"ReplicaSet\",\"name\":\"myubuntu-6d5c486b66\",\"uid\":\"d586ee55-c3d0-4b54-bdfb-87056fd7eade\"}],\"resourceVersion\":\"496774\",\"selfLink\":\"/api/v1/namespaces/test/pods/myubuntu-6d5c486b66-whfwv\",\"uid\":\"9ff898a9-41a1-4d03-bddc-fa7fa8004f0d\"},\"spec\":{\"containers\":[{\"args\":[\"while true; do ls /tsi-secrets; sleep 15; done;\"],\"command\":[\"/bin/bash\",\"-c\",\"--\"],\"image\":\"ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4\",\"imagePullPolicy\":\"Always\",\"name\":\"myubuntu\",\"resources\":{},\"terminationMessagePath\":\"/dev/termination-log\",\"terminationMessagePolicy\":\"File\",\"volumeMounts\":[{\"mountPath\":\"/var/run/secrets/kubernetes.io/serviceaccount\",\"name\":\"default-token-ncgzw\",\"readOnly\":true},{\"mountPath\":\"/tsi-secrets\",\"name\":\"tsi-secrets\",\"readOnly\":true}]},{\"env\":[{\"name\":\"HOST_IP\",\"valueFrom\":{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"status.hostIP\"}}},{\"name\":\"IS_SIDECAR\",\"value\":\"true\"},{\"name\":\"JWT_TTL_SEC\",\"value\":\"60\"},{\"name\":\"VAULT_ADDR\",\"value\":\"http://tsi-vault-v171.tsi-fra02-5240a919746a818fd9d58aa25c34ecfe-0000.eu-de.containers.appdomain.cloud\"},{\"name\":\"SECRET_REFRESH_SEC\",\"value\":\"600\"},{\"name\":\"IDENTITY_REFRESH_SEC\"}],\"image\":\"trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"imagePullPolicy\":\"Always\",\"name\":\"jwt-sidecar\",\"resources\":{},\"securityContext\":{\"runAsUser\":0},\"terminationMessagePath\":\"/dev/termination-log\",\"terminationMessagePolicy\":\"File\",\"volumeMounts\":[{\"mountPath\":\"/usr/share/secrets/tsi-secrets\",\"name\":\"tsi-secrets\"},{\"mountPath\":\"/host/sockets\",\"name\":\"tsi-sockets\"},{\"mountPath\":\"/pod-metadata\",\"name\":\"pod-metadata\",\"readOnly\":true},{\"mountPath\":\"/host/machineid\",\"name\":\"host-machineid\",\"readOnly\":true},{\"mountPath\":\"/var/run/secrets/kubernetes.io/serviceaccount\",\"name\":\"default-token-ncgzw\",\"readOnly\":true}]}],\"dnsPolicy\":\"ClusterFirst\",\"enableServiceLinks\":true,\"initContainers\":[{\"env\":[{\"name\":\"HOST_IP\",\"valueFrom\":{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"status.hostIP\"}}},{\"name\":\"IS_SIDECAR\",\"value\":\"false\"},{\"name\":\"JWT_TTL_SEC\",\"value\":\"60\"},{\"name\":\"VAULT_ADDR\",\"value\":\"http://tsi-vault-v171.tsi-fra02-5240a919746a818fd9d58aa25c34ecfe-0000.eu-de.containers.appdomain.cloud\"},{\"name\":\"SECRET_REFRESH_SEC\",\"value\":\"600\"},{\"name\":\"IDENTITY_REFRESH_SEC\",\"value\":\"600\"}],\"image\":\"trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"imagePullPolicy\":\"Always\",\"name\":\"jwt-init\",\"resources\":{},\"securityContext\":{\"runAsUser\":0},\"terminationMessagePath\":\"/dev/termination-log\",\"terminationMessagePolicy\":\"File\",\"volumeMounts\":[{\"mountPath\":\"/usr/share/secrets/tsi-secrets\",\"name\":\"tsi-secrets\"},{\"mountPath\":\"/host/sockets\",\"name\":\"tsi-sockets\"},{\"mountPath\":\"/pod-metadata\",\"name\":\"pod-metadata\",\"readOnly\":true},{\"mountPath\":\"/host/machineid\",\"name\":\"host-machineid\",\"readOnly\":true},{\"mountPath\":\"/var/run/secrets/kubernetes.io/serviceaccount\",\"name\":\"default-token-ncgzw\",\"readOnly\":true}]}],\"nodeName\":\"minikube\",\"priority\":0,\"restartPolicy\":\"Always\",\"schedulerName\":\"default-scheduler\",\"securityContext\":{},\"serviceAccount\":\"default\",\"serviceAccountName\":\"default\",\"terminationGracePeriodSeconds\":30,\"tolerations\":[{\"effect\":\"NoExecute\",\"key\":\"node.kubernetes.io/not-ready\",\"operator\":\"Exists\",\"tolerationSeconds\":300},{\"effect\":\"NoExecute\",\"key\":\"node.kubernetes.io/unreachable\",\"operator\":\"Exists\",\"tolerationSeconds\":300}],\"volumes\":[{\"name\":\"default-token-ncgzw\",\"secret\":{\"defaultMode\":420,\"secretName\":\"default-token-ncgzw\"}},{\"emptyDir\":{},\"name\":\"tsi-secrets\"},{\"hostPath\":{\"path\":\"/var/tsi-secure/sockets\",\"type\":\"Directory\"},\"name\":\"tsi-sockets\"},{\"hostPath\":{\"path\":\"/etc/machine-id\",\"type\":\"File\"},\"name\":\"host-machineid\"},{\"downwardAPI\":{\"defaultMode\":420,\"items\":[{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['tsi.secrets']\"},\"path\":\"tsi-secrets\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['tsi.identities']\"},\"path\":\"tsi-identities\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['admission.trusted.identity/ti-identity']\"},\"path\":\"ti-identity\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.name\"},\"path\":\"ti-pod-name\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.namespace\"},\"path\":\"ti-pod-namespace\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['admission.trusted.identity/tsi-images']\"},\"path\":\"tsi-images\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['admission.trusted.identity/tsi-cluster-name']\"},\"path\":\"tsi-cluster-name\"},{\"fieldRef\":{\"apiVersion\":\"v1\",\"fieldPath\":\"metadata.annotations['admission.trusted.identity/tsi-region']\"},\"path\":\"tsi-region\"}]},\"name\":\"pod-metadata\"}]},\"status\":{\"conditions\":[{\"lastProbeTime\":null,\"lastTransitionTime\":\"2020-12-08T19:00:29Z\",\"status\":\"True\",\"type\":\"Initialized\"},{\"lastProbeTime\":null,\"lastTransitionTime\":\"2020-12-08T19:00:33Z\",\"status\":\"True\",\"type\":\"Ready\"},{\"lastProbeTime\":null,\"lastTransitionTime\":\"2020-12-08T19:00:33Z\",\"status\":\"True\",\"type\":\"ContainersReady\"},{\"lastProbeTime\":null,\"lastTransitionTime\":\"2020-12-08T19:00:00Z\",\"status\":\"True\",\"type\":\"PodScheduled\"}],\"containerStatuses\":[{\"containerID\":\"docker://bb2ec5d6ad36cb1e30a257d10c9c34823bde3e2bbef5fe41bf18e1b8d5500497\",\"image\":\"trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"imageID\":\"docker-pullable://trustedseriviceidentity/ti-jwt-sidecar@sha256:c99941a4171d2dd08e6487aa92b23b3ddf3b695543ba78988a1e26a0679f1b3a\",\"lastState\":{},\"name\":\"jwt-sidecar\",\"ready\":true,\"restartCount\":0,\"started\":true,\"state\":{\"running\":{\"startedAt\":\"2020-12-08T19:00:33Z\"}}},{\"containerID\":\"docker://55b404300ebcaa4331ae87659130d7e6b37a96f417c9569980a630f1d192342e\",\"image\":\"ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4\",\"imageID\":\"docker-pullable://ubuntu@sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4\",\"lastState\":{},\"name\":\"myubuntu\",\"ready\":true,\"restartCount\":0,\"started\":true,\"state\":{\"running\":{\"startedAt\":\"2020-12-08T19:00:31Z\"}}}],\"hostIP\":\"172.17.0.2\",\"initContainerStatuses\":[{\"containerID\":\"docker://ffe7f67eb0c4cd666443b547825ce7393e4d7f14cc9b50a9249e48b444e27ef3\",\"image\":\"trustedseriviceidentity/ti-jwt-sidecar:v1.8.3\",\"imageID\":\"docker-pullable://trustedseriviceidentity/ti-jwt-sidecar@sha256:c99941a4171d2dd08e6487aa92b23b3ddf3b695543ba78988a1e26a0679f1b3a\",\"lastState\":{},\"name\":\"jwt-init\",\"ready\":true,\"restartCount\":0,\"state\":{\"terminated\":{\"containerID\":\"docker://ffe7f67eb0c4cd666443b547825ce7393e4d7f14cc9b50a9249e48b444e27ef3\",\"exitCode\":0,\"finishedAt\":\"2020-12-08T19:00:28Z\",\"reason\":\"Completed\",\"startedAt\":\"2020-12-08T19:00:03Z\"}}}],\"phase\":\"Running\",\"podIP\":\"172.18.0.5\",\"podIPs\":[{\"ip\":\"172.18.0.5\"}],\"qosClass\":\"BestEffort\",\"startTime\":\"2020-12-08T19:00:00Z\"}}\n",
            "tsi.secrets": "- tsi.secret/name: \"mysecret1xxx\"\n  tsi.secret/constraints: \"region,images\"\n  tsi.secret/local-path: \"tsi-secrets/\"\n- tsi.secret/name: \"mysecret2\"\n  tsi.secret/constraints: \"region\"\n  tsi.secret/local-path: \"tsi-secrets\"\n"
        }
    }
]
